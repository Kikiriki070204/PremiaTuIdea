<app-app-navbar></app-app-navbar>
<div class="container flex" style="margin-left: 5%;padding-top: 1%;">
    <h4 class="mb-2 text-4xl font-bold text-blue-900 dark:text-white">Reportes</h4> 
</div>
<div class="mt-2" style="margin-left: 6%; margin-right: 20%;" >
<div class="mb-4 border-b border-gray-200 dark:border-gray-700">
    <ul class="flex flex-wrap -mb-px text-sm font-medium text-center" id="default-tab" data-tabs-toggle="#default-tab-content" role="tablist">
        <li class="me-2" role="presentation">
            <button (click)="puntosClick()" class="inline-block p-4 border-b-2 rounded-t-lg" id="puntos-tab" data-tabs-target="#puntos" type="button" role="tab" aria-controls="puntos" aria-selected="false">Puntos</button>
        </li>
        <li class="me-2" role="presentation">
            <button (click)="ideasClick()" class="inline-block p-4 border-b-2 rounded-t-lg hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300" id="ideas-tab" data-tabs-target="#ideas" type="button" role="tab" aria-controls="ideas" aria-selected="false">Ideas</button>
        </li>
        <li class="me-2" role="presentation">
            <button (click)="ahorrosClick()" class="inline-block p-4 border-b-2 rounded-t-lg hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300" id="ahorros-tab" data-tabs-target="#ahorros" type="button" role="tab" aria-controls="ahorros" aria-selected="false">Ahorro</button>
        </li>
       
    </ul>
</div>
<div id="default-tab-content">
    
    
<div class="flex w-fit">
    <!--Inicio de calendario-->
        <div class="">
          <div>
            <div class="container mx-auto px-4 py-2 md:py-10 flex flex-col items-center justify-center">
              <div class="flex mb-1 w-40">
                <label for="datepicker" class="font-bold mb-1 mr-2 text-gray-700 ">Fecha inicial</label>
                <div class="relative">
                  <input type="hidden" name="date">
                  <input
                                type="text"
                                readonly
                                [(ngModel)]="datepickerValue"
                                class="w-full pl-4 pr-10 py-3 leading-none rounded-lg shadow-sm focus:outline-none focus:shadow-outline text-gray-600 font-medium"
                                placeholder="Select date"
                                (click)="showDatepicker = !showDatepicker">
      
                  <div class="absolute top-0 right-0 px-3 py-2">
                    <svg class="h-6 w-6 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                    </svg>
                  </div>
      
      
                  <!-- <div x-text="no_of_days.length"></div>
                                <div x-text="32 - new Date(year, month, 32).getDate()"></div>
                                <div x-text="new Date(year, month).getDay()"></div> -->
      
                  <div *ngIf="showDatepicker" class="bg-white mt-12 rounded-lg shadow p-4 absolute top-0 left-0"
                    style="width: 17rem">
      
      
                    <div class="flex justify-between items-center mb-2">
                      <div>
                        <span class="text-lg font-bold text-gray-800">{{MONTH_NAMES[month]}}</span>
                        <span class="ml-1 text-lg text-gray-600 font-normal">{{year}}</span>
                      </div>
                      <div>
                        <button
                             type="button"
                             class="transition ease-in-out duration-100 inline-flex cursor-pointer hover:bg-gray-200 p-1 rounded-full"
                             [ngClass]="{'cursor-not-allowed opacity-25': month == 0}"
                             [disabled]="month == 0 ? true : false"
                             (click)="month = month -1; getNoOfDays()"
      
                                                >
      
                                                <svg class="h-6 w-6 text-gray-500 inline-flex"  fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                                                </svg>  
                                            </button>
                        <button
                            type="button"
                            class="transition ease-in-out duration-100 inline-flex cursor-pointer hover:bg-gray-200 p-1 rounded-full"
                            [ngClass]="{'cursor-not-allowed opacity-25': month == 11 }"
                            [disabled]="month == 11 ? true : false"
                            (click)="month = month +1; getNoOfDays()"
                                                >
      
                                                <svg class="h-6 w-6 text-gray-500 inline-flex"  fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                                                </svg>									  
                                            </button>
                      </div>
                    </div>
      
                    <div class="mb-3 -mx-1 grid grid-cols-7">
                      <div *ngFor="let day of DAYS; let i = index" class="">
                        <div class="" class="px-1">
                          <div class="text-gray-800 font-medium text-center text-xs">{{day}}</div>
                        </div>
                      </div>
                      <!-- <template x-for="(day, index) in DAYS" :key="index">	
                                            <div style="width: 14.26%" class="px-1">
                                                <div
                                                    x-text="day" 
                                                    class="text-gray-800 font-medium text-center text-xs"></div>
                                            </div>
                                        </template> -->
                    </div>
      
                    <div class="-mx-1 grid grid-cols-7">
                      <div *ngFor="let blankday of blankdays">
                        <div class="text-center border p-1 border-transparent text-sm"></div>
                      </div>
                      <!-- <template x-for="blankday in blankdays">
                                            <div 
                                                style="width: 14.28%"
                                                class="text-center border p-1 border-transparent text-sm"	
                                            ></div>
                                        </template>	 -->
                      <div *ngFor="let date of no_of_days" class="grid grid-cols-7">
                        <div class="px-1 mb-1">
                          <button (click)="getDateValue(date)"
                            class="self-center text-center text-sm  rounded-full leading-loose transition ease-in-out duration-100"
                            [ngClass]="{'bg-blue-500 text-white': isToday(date), 'text-gray-700 hover:bg-blue-200': !isToday(date) }">
                            {{date}}</button>
                        </div>
                      </div>
                      <!-- <template x-for="(date, dateIndex) in no_of_days" :key="dateIndex">	
                                            <div style="width: 14.28%" class="px-1 mb-1">
                                                <div
                                                    @click="getDateValue(date)"
                                                    x-text="date"
                                                    class="cursor-pointer text-center text-sm leading-none rounded-full leading-loose transition ease-in-out duration-100"
                                                    :class="{'bg-blue-500 text-white': isToday(date) == true, 'text-gray-700 hover:bg-blue-200': isToday(date) == false }"	
                                                ></div>
                                            </div>
                                        </template> -->
                    </div>
                  </div>
      
                </div>
              </div>
      
            </div>
          </div>
      
      
        </div>

    <!--Fin del calendario-->


     <!--Inicio de calendario-->
    
     <div class="">
        <div>
          <div class="container mx-auto px-4 py-2 md:py-10 flex flex-col items-center justify-center">
            <div class="flex mb-1 w-40">
              <label for="datepicker" class="font-bold mb-1 mr-2 text-gray-700 ">Fecha final</label>
              <div class="relative">
                <input type="hidden" name="date">
                <input
                              type="text"
                              readonly
                              [(ngModel)]="datepickerValue2"
                              class="w-full pl-4 pr-10 py-3 leading-none rounded-lg shadow-sm focus:outline-none focus:shadow-outline text-gray-600 font-medium"
                              placeholder="Select date"
                              (click)="showDatepicker2 = !showDatepicker2">
    
                <div class="absolute top-0 right-0 px-3 py-2">
                  <svg class="h-6 w-6 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                  </svg>
                </div>
    
    
                <!-- <div x-text="no_of_days.length"></div>
                              <div x-text="32 - new Date(year, month, 32).getDate()"></div>
                              <div x-text="new Date(year, month).getDay()"></div> -->
    
                <div *ngIf="showDatepicker2" class="bg-white mt-12 rounded-lg shadow p-4 absolute top-0 left-0"
                  style="width: 17rem">
    
    
                  <div class="flex justify-between items-center mb-2">
                    <div>
                      <span class="text-lg font-bold text-gray-800">{{MONTH_NAMES[month]}}</span>
                      <span class="ml-1 text-lg text-gray-600 font-normal">{{year}}</span>
                    </div>
                    <div>
                      <button
                           type="button"
                           class="transition ease-in-out duration-100 inline-flex cursor-pointer hover:bg-gray-200 p-1 rounded-full"
                           [ngClass]="{'cursor-not-allowed opacity-25': month == 0}"
                           [disabled]="month == 0 ? true : false"
                           (click)="month = month -1; getNoOfDays()"
    
                                              >
    
                                              <svg class="h-6 w-6 text-gray-500 inline-flex"  fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                                              </svg>  
                                          </button>
                      <button
                          type="button"
                          class="transition ease-in-out duration-100 inline-flex cursor-pointer hover:bg-gray-200 p-1 rounded-full"
                          [ngClass]="{'cursor-not-allowed opacity-25': month == 11 }"
                          [disabled]="month == 11 ? true : false"
                          (click)="month = month +1; getNoOfDays()"
                                              >
    
                                              <svg class="h-6 w-6 text-gray-500 inline-flex"  fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                                              </svg>									  
                                          </button>
                    </div>
                  </div>
    
                  <div class="mb-3 -mx-1 grid grid-cols-7">
                    <div *ngFor="let day of DAYS; let i = index" class="">
                      <div class="" class="px-1">
                        <div class="text-gray-800 font-medium text-center text-xs">{{day}}</div>
                      </div>
                    </div>
                    <!-- <template x-for="(day, index) in DAYS" :key="index">	
                                          <div style="width: 14.26%" class="px-1">
                                              <div
                                                  x-text="day" 
                                                  class="text-gray-800 font-medium text-center text-xs"></div>
                                          </div>
                                      </template> -->
                  </div>
    
                  <div class="-mx-1 grid grid-cols-7">
                    <div *ngFor="let blankday of blankdays">
                      <div class="text-center border p-1 border-transparent text-sm"></div>
                    </div>
                    <!-- <template x-for="blankday in blankdays">
                                          <div 
                                              style="width: 14.28%"
                                              class="text-center border p-1 border-transparent text-sm"	
                                          ></div>
                                      </template>	 -->
                    <div *ngFor="let date of no_of_days" class="grid grid-cols-7">
                      <div class="px-1 mb-1">
                        <button (click)="getDateValue2(date)"
                          class="self-center text-center text-sm  rounded-full leading-loose transition ease-in-out duration-100"
                          [ngClass]="{'bg-blue-500 text-white': isToday(date), 'text-gray-700 hover:bg-blue-200': !isToday(date) }">
                          {{date}}</button>
                      </div>
                    </div>
                    <!-- <template x-for="(date, dateIndex) in no_of_days" :key="dateIndex">	
                                          <div style="width: 14.28%" class="px-1 mb-1">
                                              <div
                                                  @click="getDateValue(date)"
                                                  x-text="date"
                                                  class="cursor-pointer text-center text-sm leading-none rounded-full leading-loose transition ease-in-out duration-100"
                                                  :class="{'bg-blue-500 text-white': isToday(date) == true, 'text-gray-700 hover:bg-blue-200': isToday(date) == false }"	
                                              ></div>
                                          </div>
                                      </template> -->
                  </div>
                </div>
    
              </div>
            </div>
    
          </div>
        </div>
    
    
      </div>
  <!--Fin del calendario-->
  @if(tab == 0)
  {
<div class="h-5 mt-3"> 
    <button (click)="renderHistorialsByDate()" class="p-2.5 ms-2 text-sm font-medium text-white bg-blue-800 rounded-lg border border-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">
        <svg class="w-4 h-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"/>
        </svg>
        <span class="sr-only">Buscar</span>
    </button>  
</div>
<div class="h-5 mt-3.5 ml-1">
    <button (click)="cleanCharts()" type="button" class="p-2.5 ms-2 text-sm font-medium text-white bg-green-700 rounded-lg border border-green-700 hover:bg-green-800 focus:ring-4 focus:outline-none focus:ring-green-300 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800">Limpiar</button>
</div>
  }
  @else if (tab == 1) {
    <div class="h-5 mt-3"> 
      <button (click)="renderIdeasByDate()" class="p-2.5 ms-2 text-sm font-medium text-white bg-blue-800 rounded-lg border border-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">
          <svg class="w-4 h-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
              <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"/>
          </svg>
          <span class="sr-only">Buscar</span>
      </button>  
  </div>
  <div class="h-5 mt-3.5 ml-1">
      <button (click)="cleanCharts()" type="button" class="p-2.5 ms-2 text-sm font-medium text-white bg-green-700 rounded-lg border border-green-700 hover:bg-green-800 focus:ring-4 focus:outline-none focus:ring-green-300 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800">Limpiar</button>
  </div>
  
  }
  @else {
    <div class="h-5 mt-3"> 
      <button (click)="renderSavingsByDate()" class="p-2.5 ms-2 text-sm font-medium text-white bg-blue-800 rounded-lg border border-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">
          <svg class="w-4 h-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
              <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"/>
          </svg>
          <span class="sr-only">Buscar</span>
      </button>  
  </div>
  <div class="h-5 mt-3.5 ml-1">
      <button (click)="cleanCharts()" type="button" class="p-2.5 ms-2 text-sm font-medium text-white bg-green-700 rounded-lg border border-green-700 hover:bg-green-800 focus:ring-4 focus:outline-none focus:ring-green-300 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800">Limpiar</button>
  </div>
  }

</div>

    <div class="hidden p-2 rounded-lg dark:bg-gray-800" id="puntos" role="tabpanel" aria-labelledby="puntos-tab">
        <h4 class=" mt-2 mb-2 text-xl font-bold text-blue-900 dark:text-white">Top 10 usuarios con más puntos</h4> 
        <div class="p-4 rounded-lg bg-gray-50 dark:bg-gray-800">
            <div class="w-full">
                <canvas id="top10">
                </canvas>
            </div>  
        </div>
        <br>
        <h4 class="mb-2 text-xl font-bold text-blue-900 dark:text-white">Puntos asignados a ideas contables</h4> 
        <div class="p-4 rounded-lg bg-gray-50 dark:bg-gray-800">
            <div class="w-full">
                <canvas id="puntosCountable">
                </canvas>
            </div>  
        </div>
        <br>
        <h4 class="mb-2 text-xl font-bold text-blue-900 dark:text-white">Puntos asignados a ideas no contables</h4> 
        <div class="p-4 rounded-lg bg-gray-50 dark:bg-gray-800">
            <div class="w-full">
                <canvas id="puntosUncountable">
                </canvas>
            </div>  
        </div>

    
    </div>

    <!--Ideas-->
    <div class=" hidden p-2 rounded-lg dark:bg-gray-800" id="ideas" role="tabpanel" aria-labelledby="ideas-tab">
        <h4 class="mt-2 mb-2 text-xl font-bold text-blue-900 dark:text-white">Contables</h4> 
        <div class="p-4 rounded-lg bg-gray-50 dark:bg-gray-800">
            <div class="w-full">
                <canvas id="countable">
                </canvas>
            </div>  
        </div>
        <br>
        <h4 class="mb-2 text-xl font-bold text-blue-900 dark:text-white">No contables</h4> 
        <div class="p-4 rounded-lg bg-gray-50 dark:bg-gray-800">
            <div class="w-full">
                <canvas id="ctx">
                </canvas>
            </div> 
        </div>

    </div>

    <!--Ahorro-->
    <div class="hidden p-2 rounded-lg dark:bg-gray-800" id="ahorros" role="tabpanel" aria-labelledby="ahorros-tab">
            <h4 class="mt-2 mb-2 text-xl font-bold text-blue-900 dark:text-white">Ahorro por area</h4> 
            <div class="p-4 rounded-lg bg-gray-50 dark:bg-gray-800">
                <div class="w-full">
                    <canvas id="ahorro">
                    </canvas>
                </div>  
            </div>
    </div>
    
</div>





</div>
<!--
Ojo
<div style="width: 800px;">
    <canvas id="ctx">
    </canvas>
</div>
-->